{"ast":null,"code":"import { sendMessageToParent as e } from \"../internal/communication.js\";\nimport { ensureInitialized as r } from \"../internal/internalAPIs.js\";\nimport { decodeAttachment as t, createFile as n } from \"../internal/mediaUtil.js\";\nimport { getLogger as l, getApiVersionTag as i } from \"../internal/telemetry.js\";\nimport { FrameContexts as o, errorNotSupportedOnPlatform as s } from \"./constants.js\";\nimport { ErrorCode as a } from \"./interfaces.js\";\nimport { runtime as u } from \"./runtime.js\";\nconst c = l(\"thirdPartyCloudStorage\");\nclass f {\n  constructor(e, r) {\n    this.fileType = e, this.assembleAttachment = r;\n  }\n}\nlet d = [],\n  h = null,\n  m = !0,\n  p = null;\nfunction g(t, n) {\n  if (!n) throw new Error(\"[getDragAndDropFiles] Callback cannot be null\");\n  if (t && \"\" !== t) {\n    if (r(u, o.content, o.task), !C()) throw s;\n    if (p) throw p = null, new Error(\"getDragAndDropFiles cannot be called twice\");\n    p = n, m = !0, e(i(\"v2\", \"thirdPartyCloudStorage.getDragAndDropFiles\"), \"thirdPartyCloudStorage.getDragAndDropFiles\", [t], R);\n  } else {\n    n([], {\n      errorCode: a.INVALID_ARGUMENTS\n    });\n  }\n}\nfunction R(e) {\n  if (p) if (e && e.error) p([], e.error), p = null;else if (e && e.fileChunk) try {\n    m || 0 !== e.fileChunk.chunkSequence || (c(\"Last chunk is not received or 'endOfFile' value for previous chunk was not set to true\"), m = !0, p([], {\n      errorCode: a.INTERNAL_ERROR,\n      message: \"error occurred while receiving data\"\n    }), d = [], p = null);\n    const r = t(e.fileChunk, e.fileType);\n    if (r ? (h || (h = new f(e.fileType, [])), h.assembleAttachment.push(r)) : (c(\"Received a null assemble attachment for when decoding chunk sequence \".concat(e.fileChunk.chunkSequence, \"; not including the chunk in the assembled file.\")), p ? p([], {\n      errorCode: a.INTERNAL_ERROR,\n      message: \"error occurred while receiving data\"\n    }) : p = null, d = [], p = null, m = !0), m = e.fileChunk.endOfFile, e.fileChunk.endOfFile && h) {\n      const r = n(h.assembleAttachment, h.fileType);\n      if (r) {\n        const t = new File([r], e.fileName, {\n          type: r.type\n        });\n        d.push(t);\n      }\n      e.isLastFile && p && (p(d, e.error), d = [], p = null, m = !0), h = null;\n    }\n  } catch (e) {\n    p && (p([], {\n      errorCode: a.INTERNAL_ERROR,\n      message: e\n    }), d = [], p = null, m = !0);\n  } else p([], {\n    errorCode: a.INTERNAL_ERROR,\n    message: \"data received is null\"\n  }), d = [], p = null, m = !0;\n}\nfunction C() {\n  return !(!r(u) || !u.supports.thirdPartyCloudStorage);\n}\nexport { g as getDragAndDropFiles, C as isSupported };","map":{"version":3,"names":["sendMessageToParent","e","ensureInitialized","r","decodeAttachment","t","createFile","n","getLogger","l","getApiVersionTag","i","FrameContexts","o","errorNotSupportedOnPlatform","s","ErrorCode","a","runtime","u","c","f","constructor","fileType","assembleAttachment","d","h","m","p","g","Error","content","task","C","R","errorCode","INVALID_ARGUMENTS","error","fileChunk","chunkSequence","INTERNAL_ERROR","message","push","concat","endOfFile","File","fileName","type","isLastFile","supports","thirdPartyCloudStorage","getDragAndDropFiles","isSupported"],"sources":["D:/KattSafe/pdf-qa-frontend/node_modules/@microsoft/teams-js/dist/esm/packages/teams-js/src/public/thirdPartyCloudStorage.js"],"sourcesContent":["import{sendMessageToParent as e}from\"../internal/communication.js\";import{ensureInitialized as r}from\"../internal/internalAPIs.js\";import{decodeAttachment as t,createFile as n}from\"../internal/mediaUtil.js\";import{getLogger as l,getApiVersionTag as i}from\"../internal/telemetry.js\";import{FrameContexts as o,errorNotSupportedOnPlatform as s}from\"./constants.js\";import{ErrorCode as a}from\"./interfaces.js\";import{runtime as u}from\"./runtime.js\";const c=l(\"thirdPartyCloudStorage\");class f{constructor(e,r){this.fileType=e,this.assembleAttachment=r}}let d=[],h=null,m=!0,p=null;function g(t,n){if(!n)throw new Error(\"[getDragAndDropFiles] Callback cannot be null\");if(t&&\"\"!==t){if(r(u,o.content,o.task),!C())throw s;if(p)throw p=null,new Error(\"getDragAndDropFiles cannot be called twice\");p=n,m=!0,e(i(\"v2\",\"thirdPartyCloudStorage.getDragAndDropFiles\"),\"thirdPartyCloudStorage.getDragAndDropFiles\",[t],R)}else{n([],{errorCode:a.INVALID_ARGUMENTS})}}function R(e){if(p)if(e&&e.error)p([],e.error),p=null;else if(e&&e.fileChunk)try{m||0!==e.fileChunk.chunkSequence||(c(\"Last chunk is not received or 'endOfFile' value for previous chunk was not set to true\"),m=!0,p([],{errorCode:a.INTERNAL_ERROR,message:\"error occurred while receiving data\"}),d=[],p=null);const r=t(e.fileChunk,e.fileType);if(r?(h||(h=new f(e.fileType,[])),h.assembleAttachment.push(r)):(c(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),p?p([],{errorCode:a.INTERNAL_ERROR,message:\"error occurred while receiving data\"}):p=null,d=[],p=null,m=!0),m=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&h){const r=n(h.assembleAttachment,h.fileType);if(r){const t=new File([r],e.fileName,{type:r.type});d.push(t)}e.isLastFile&&p&&(p(d,e.error),d=[],p=null,m=!0),h=null}}catch(e){p&&(p([],{errorCode:a.INTERNAL_ERROR,message:e}),d=[],p=null,m=!0)}else p([],{errorCode:a.INTERNAL_ERROR,message:\"data received is null\"}),d=[],p=null,m=!0}function C(){return!(!r(u)||!u.supports.thirdPartyCloudStorage)}export{g as getDragAndDropFiles,C as isSupported};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}